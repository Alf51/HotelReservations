create table hotels
(
    id          int primary key generated by default as identity,
    name        varchar(100) not null,
    address     varchar      not null,
    rating      int check ( rating >= 0 and hotels.rating <= 5 ),
    description varchar
);

insert into hotels(name, address, rating, description)
VALUES ('Zemlanka', 'St.Petersburg, street Kaliban 72', 5, 'Best hotel in the world');

insert into hotels(name, address, rating, description)
VALUES ('Yma', 'Kola, Lilte Petranka 19', 2, 'it is scary to me');

insert into hotels(name, address, rating, description)
VALUES ('Cosmos', 'Moscow, Macragg 18', 5, 'it is vary large');

insert into hotels(name, address, rating, description)
VALUES ('Centr', 'Ekaterinburg, Boris Yeltsin Street 3', 4, 'Музей и отель в одном флаконе');

insert into hotels(name, address, rating, description)
VALUES ('AZIMUT', 'Murmansk, Lenina 82', 4, 'Форпост Севера');

insert into hotels(name, address, rating, description)
VALUES ('Magnus', 'Omsk, Prospero 7', 1, 'Самое то, для семейного чила');



create table rooms
(
    id           bigint primary key generated by default as identity,
    room_number  int                                          not null,
    room_size    double precision                             not null check ( room_size > 0 ),
    is_available boolean DEFAULT true,
    id_hotel     int references hotels (id) on delete cascade not null
);


insert into rooms(room_number, room_size, id_hotel)
VALUES (101, 14.4, 1);
insert into rooms(room_number, room_size, id_hotel)
VALUES (102, 24.4, 1);
insert into rooms(room_number, room_size, id_hotel)
VALUES (103, 32, 1);

insert into rooms(room_number, room_size, id_hotel)
VALUES (21, 10, 2);
insert into rooms(room_number, room_size, id_hotel)
VALUES (22, 30, 2);
insert into rooms(room_number, room_size, id_hotel)
VALUES (33, 30, 2);

insert into rooms(room_number, room_size, id_hotel)
VALUES (1001, 20, 3);
insert into rooms(room_number, room_size, id_hotel)
VALUES (1002, 22.3, 3);
insert into rooms(room_number, room_size, id_hotel)
VALUES (1003, 99, 3);

insert into rooms(room_number, room_size, id_hotel)
VALUES (10, 24.4, 4);
insert into rooms(room_number, room_size, id_hotel)
VALUES (12, 54.4, 4);
insert into rooms(room_number, room_size, id_hotel)
VALUES (26, 32, 4);

insert into rooms(room_number, room_size, id_hotel)
VALUES (501, 14.4, 5);
insert into rooms(room_number, room_size, id_hotel)
VALUES (502, 24.4, 5);
insert into rooms(room_number, room_size, id_hotel)
VALUES (503, 18, 5);

insert into rooms(room_number, room_size, id_hotel)
VALUES (101, 7.4, 6);
insert into rooms(room_number, room_size, id_hotel)
VALUES (102, 12.4, 6);
insert into rooms(room_number, room_size, id_hotel)
VALUES (103, 9, 6);



CREATE table clients
(
    id        int primary key generated by default as identity,
    name      varchar(100) not null,
    login     varchar(100) not null unique,
    password  varchar      not null,
    birthdate date         not null
);


insert into clients(name, login, password, birthdate)
VALUES ('Dorn', 'dorn51', '$2a$10$.ulgt.FpWssjM0R6S1BCPOt8vsPt5icsIjNeUQ1FXK47Po25/oqjG', '2000-01-01');

insert into clients(name, login, password, birthdate)
VALUES ('Leon', 'kalibanforever', '$2a$10$.ulgt.FpWssjM0R6S1BCPOt8vsPt5icsIjNeUQ1FXK47Po25/oqjG', '1993-04-05');

insert into clients(name, login, password, birthdate)
VALUES ('Jiliman', 'utlra', '$2a$10$.ulgt.FpWssjM0R6S1BCPOt8vsPt5icsIjNeUQ1FXK47Po25/oqjG', '2003-02-11');

insert into clients(name, login, password, birthdate)
VALUES ('Magnus', 'red', '$2a$10$.ulgt.FpWssjM0R6S1BCPOt8vsPt5icsIjNeUQ1FXK47Po25/oqjG', '1942-09-11');

insert into clients(name, login, password, birthdate)
VALUES ('Vasiliy', 'user51', '$2a$10$.ulgt.FpWssjM0R6S1BCPOt8vsPt5icsIjNeUQ1FXK47Po25/oqjG', '1999-05-03');


CREATE table users_role
(
    id        int primary key generated by default as identity,
    id_client int references clients (id) on DELETE cascade not null,
    roles      varchar(50)                                   not null default ('GUEST')

);

insert into users_role(id_client, roles)
VALUES (1, 'ADMIN');
insert into users_role(id_client, roles)
VALUES (2, 'USER');
insert into users_role(id_client, roles)
VALUES (3, 'USER');
insert into users_role(id_client, roles)
VALUES (4, 'USER');
insert into users_role(id_client, roles)
VALUES (5, 'USER');


CREATE table Reviews
(
    id        int primary key generated by default as identity,
    rating    int                                           not null check ( rating >= 0 and rating <= 5),
    review    varchar(900),
    date      date                                          not null default current_date,
    id_client int references clients (id) on DELETE cascade not null,
    id_hotel  int references hotels (id) on DELETE cascade  not null
);

insert into reviews(rating, review, date, id_client, id_hotel)
VALUES (3, 'С пивом потянет', '2019-04-08', 1, 1);

insert into reviews(rating, review, date, id_client, id_hotel)
VALUES (4, 'Норм место', '2019-04-08', 1, 2);

insert into reviews(rating, review, date, id_client, id_hotel)
VALUES (5, 'Как греческие боги отдохнул', '2022-04-08', 2, 3);

insert into reviews(rating, review, date, id_client, id_hotel)
VALUES (5, 'Шикарный отель', '2022-04-08', 2, 2);

insert into reviews(rating, review, date, id_client, id_hotel)
VALUES (3, 'Ночь переспать на тройку понтянет', '2023-07-11', 3, 2);

insert into reviews(rating, review, date, id_client, id_hotel)
VALUES (3, 'Не съели и на том спасибо', '2023-07-11', 3, 2);

insert into reviews(rating, review, date, id_client, id_hotel)
VALUES (4, 'Дороговато вышло, но в целом норм', '2023-07-11', 4, 4);

insert into reviews(rating, review, date, id_client, id_hotel)
VALUES (3, 'Хотел посмотреть музей клавиатуры, а попал ... в центр', '2023-10-12', 5, 4);

insert into reviews(rating, review, date, id_client, id_hotel)
VALUES (4, 'Вначале подумал, что это торговый центр', '2023-12-07',2, 4);

insert into reviews(rating, review, date, id_client, id_hotel)
VALUES (3, 'Северного сияния не увидел, хотя обещали, что будет видно с балкона (', '2023-12-10', 3, 5);

insert into reviews(rating, review, date, id_client, id_hotel)
VALUES (4, 'Место не чего, но на ресепшене работает хамка (', '2023-12-10', 4, 6);


CREATE table Books
(
    id        int primary key generated by default as identity,
    check_in  DATE check ( check_in >= current_date )   not null,
    check_out DATE check ( check_out > Books.check_in ) not null,
    id_client int                                       not null references clients (id) on delete cascade,
    id_room   int                                       not null references rooms (id) on delete cascade
);

insert into Books (check_in, check_out, id_client, id_room)
VALUES (current_date, current_date + 5, 1, 1);

insert into Books (check_in, check_out, id_client, id_room)
VALUES (current_date + 10, current_date + 25, 1, 2);

insert into Books (check_in, check_out, id_client, id_room)
VALUES (current_date, current_date + 30, 2, 3);

insert into Books (check_in, check_out, id_client, id_room)
VALUES (current_date + 40, current_date + 60, 2, 2);

insert into Books (check_in, check_out, id_client, id_room)
VALUES (current_date, current_date + 90, 3, 2);

insert into Books (check_in, check_out, id_client, id_room)
VALUES (current_date, current_date + 90, 3, 2);

insert into Books (check_in, check_out, id_client, id_room)
VALUES (current_date, current_date + 90, 5, 9);

insert into Books (check_in, check_out, id_client, id_room)
VALUES (current_date, current_date + 90, 4, 10);

insert into Books (check_in, check_out, id_client, id_room)
VALUES (current_date, current_date + 90, 5, 11);

insert into Books (check_in, check_out, id_client, id_room)
VALUES ('2023-12-01', '2023-12-25', 2, 4);



